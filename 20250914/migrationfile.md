# マイグレーションファイルについて

## マイグレーションファイルを消してはいけない理由
マイグレーションファイルは、変更履歴と他環境へ同じ環境を適用するための手順書だから。
<br>
rails db:migrate:statusで、マイグレーションが下書きか本書きか確認できる。
upなら本書き状態、downなら下書き状態。


## 反映済みのマイグレーションファイルを修正したいとき
### 方法1. ロールバックする
まだ他の人や本番に適用していない場合のみ有効な方法。down状態のマイグレーションファイルを編集して、再度DBに反映させればOK。  
`rails db:rollback STEP=数値`で、複数のファイルを差し戻すことが可能。  
`rails db:migrate:down VERSION=マイグレーションID`で、選択のマイグレーションファイルのみを差し戻すことが可能。  
マイグレーションファイルの状態を確認して、downになっていたら修正開始して、修正後にupに戻す（`rails db:migrate`でDB反映)。

### 方法2. 新規マイグレーションファイルを作成する
既に共有・本番適用済なら、新しいマイグレーションで修正する。

## 参考
<a>https://railsguides.jp/active_record_migrations.html#change%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E4%BD%BF%E3%81%86</a>
